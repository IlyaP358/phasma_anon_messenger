<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Group Chat - phasma</title>
  <link rel="icon" type="image/png" href="/static/icon.png">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <link rel="stylesheet" href="/static/css/group_chat.css">
</head>

<body>
  <div id="drag-drop-overlay">
    <div class="drag-drop-box">
      <img src="/static/phasma_file.png" alt="Upload" class="drag-drop-icon" />
      <p class="drag-drop-text">Upload File</p>
    </div>
  </div>

  <div id="error-notification"></div>

  <div id="confirm-modal" class="modal-overlay">
    <div class="modal-dialog">
      <div class="modal-title">‚ö†Ô∏è Delete Message</div>
      <div class="modal-message">Are you sure you want to delete this message?
        This action cannot be undone.</div>
      <div class="modal-buttons">
        <button class="modal-btn modal-btn-cancel" id="modal-cancel">Cancel</button>
        <button class="modal-btn modal-btn-confirm" id="modal-confirm">Delete</button>
      </div>
    </div>
  </div>

  <button id="leave-btn">‚Üê Leave Group</button>

  <div class="chat-wrapper">
    <div class="chat-main">
      <div class="chat-header">
        <div class="chat-header-left">
          <h3 id="group-name">Loading...</h3>
          <div class="chat-user-badge">Logged as:
            <span id="chat-user">...</span>
          </div>
        </div>
      </div>

      <div id="out">
        <div id="load-more-container">
          <button id="load-more-btn">‚Üì Load older messages</button>
        </div>
        <div id="messages-container"></div>
      </div>

      <div id="input-container">
        <div id="file-preview-container">
          <div class="preview-thumbnail" id="preview-thumbnail">
            <img id="preview-img" style="display: none;" />
            <video id="preview-video" style="display: none;"></video>
            <img id="preview-file-icon" class="file-icon" style="display: none;" src="/static/phasma_file.png" />
          </div>
          <div class="preview-info">
            <div class="preview-source" id="preview-source"></div>
            <div class="preview-filename" id="preview-filename"></div>
            <div class="preview-filesize" id="preview-filesize"></div>
          </div>
          <div class="preview-actions">
            <button type="button" class="preview-btn" id="preview-remove-btn">‚úï Remove</button>
          </div>
        </div>

        <div class="input-row">
          <input type="text" id="in" autocomplete="off" placeholder="Type a message" />
          <button type="button" class="input-button" id="upload-btn">+ File</button>
          <button type="button" class="input-button" id="emoji-btn">üòÇ</button>
          <button type="button" class="input-button" id="send-btn">‚Ü≥</button>
        </div>

        <input id="file-input" type="file"
          accept="image/jpeg,image/png,image/gif,image/webp,video/mp4,video/quicktime,video/webm,audio/mpeg,audio/mp4,audio/ogg,audio/wav,application/pdf,text/plain" />
      </div>
    </div>

    <div class="members-sidebar">
      <div class="members-header">
        Members <span class="members-count" id="members-count">(0)</span>
      </div>
      <div id="members-list"></div>
    </div>
  </div>

  <div id="emoji-picker-modal" class="emoji-picker-modal">
    <div class="emoji-picker-container">
      <div class="emoji-picker-header">
        <input type="text" id="emoji-search" class="emoji-search" placeholder="Search emoji..." />
        <button type="button" class="emoji-close-btn" id="emoji-close-btn">x</button>
      </div>

      <div class="emoji-categories-tabs">
        <button type="button" class="emoji-tab active" data-category="frequent">‚è±Ô∏è</button>
        <button type="button" class="emoji-tab" data-category="smileys">:)</button>
        <button type="button" class="emoji-tab" data-category="people">hi</button>
        <button type="button" class="emoji-tab" data-category="nature">leaf</button>
        <button type="button" class="emoji-tab" data-category="food">food</button>
        <button type="button" class="emoji-tab" data-category="travel">car</button>
        <button type="button" class="emoji-tab" data-category="objects">bulb</button>
        <button type="button" class="emoji-tab" data-category="symbols">heart</button>
      </div>

      <div class="emoji-picker-content">
        <div id="emoji-grid" class="emoji-grid"></div>
      </div>
    </div>
  </div>

  <script nonce="{{ nonce }}">
    const GROUP_ID = {{ group_id| tojson }};
    const TEMPLATE_USER = {{ user| tojson }};
    const TEMPLATE_GROUP_TOKEN = {{ auth_token| tojson }};
    const GROUP_NAME = {{ group_name| tojson }};
  </script>
  <script nonce="{{ nonce }}" src="/static/js/group_chat.js"></script>
</body>

</html>